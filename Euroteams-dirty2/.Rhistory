)
}
plot_cluster(restsne, as.factor(dbres$cluster))
##explore ####
df[clusts==9,c('Player', 'Pos')]
##explore ####
df[clusts==8,c('Player', 'Pos')]
##explore ####
df[clusts==9,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
attvars<-c("npxG", 'Shots', 'SoT', 'ShotperTouch',
'xA', 'KP', 'KPperTouch',
"PassPrgDist", 'PassCmpperc',
'KP', 'CrsPA',
'PassLive',
'AttDrib', 'SuccDrib')
atttrim<-select(df, one_of(attvars))
attscaled<-atttrim %>% scale %>% as.data.frame()
attscaled[attscaled > 3]<-3
attscaled[attscaled < -3]<- -3
## PCA varimax ####
res.pca <- PCA(attscaled, graph=FALSE, ncp=7)
res.pca$var$cor %>% # table with factor loadings
promax
## PCA varimax ####
res.pca <- PCA(attscaled, graph=FALSE, ncp=6)
res.pca$var$cor %>% # table with factor loadings
promax
fit <- psych::pca(attscaled, nfactors=6, rotate = "promax")
print(fit)
simple<-fit$scores %>% as.data.frame()
colnames(simple)<-c('Finishing', 'Creating','Dribbling',
'DeepProg', 'Crossing','BallRetention')
attsimple<-simple
set.seed(20)
tsne<-Rtsne::Rtsne(attsimple, perplexity=9)
plot(tsne$Y)
set.seed(20)
tsne<-Rtsne::Rtsne(attsimple, perplexity=10)
plot(tsne$Y)
set.seed(20)
tsne<-Rtsne::Rtsne(attsimple, perplexity=8)
plot(tsne$Y)
tsne<-Rtsne::Rtsne(attsimple, perplexity=8)
plot(tsne$Y)
tsne<-Rtsne::Rtsne(attsimple, perplexity=7)
plot(tsne$Y)
set.seed(20)
tsne<-Rtsne::Rtsne(attsimple, perplexity=7)
plot(tsne$Y)
restsne<-tsne$Y %>% as.data.frame()
resclv3<-clValid(restsne, validation='internal',
clMethods=c('hierarchical', 'kmeans',
'diana', 'som', 'clara'),
nClust=4:15,
method='average')
summary(resclv3)
hdbres<-hdbscan(restsne, 5)
plot_cluster(restsne, as.factor(hdbres$cluster))
hdbres<-hdbscan(restsne, 6)
plot_cluster(restsne, as.factor(hdbres$cluster))
hdbres<-hdbscan(restsne, 7)
plot_cluster(restsne, as.factor(hdbres$cluster))
hdbres<-hdbscan(restsne, 4)
plot_cluster(restsne, as.factor(hdbres$cluster))
hdbres<-hdbscan(restsne, 5)
plot_cluster(restsne, as.factor(hdbres$cluster))
hdbres<-hdbscan(restsne, 6)
plot_cluster(restsne, as.factor(hdbres$cluster))
kNNdistplot(restsne, k=5)
dbres<-dbscan(restsne, minPts = 4, eps=3.5)
dbres<-dbscan(restsne, minPts = 4, eps=4.5)
plot_cluster(restsne, as.factor(dbres$cluster))
clusts<-dbres$cluster %>% as.factor()
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
##explore ####
df[clusts==9,c('Player', 'Pos')]
##explore ####
df[clusts==8,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
##explore ####
df[clusts==6,c('Player', 'Pos')]
##explore ####
df[clusts==4,c('Player', 'Pos')]
clusts<-dbres$cluster %>% as.factor()
plot_cluster(restsne, as.factor(dbres$cluster))
##explore ####
df[clusts==3,c('Player', 'Pos')]
##explore ####
df[clusts==2,c('Player', 'Pos')]
resclv3<-clValid(attsimple, validation='internal',
clMethods=c('hierarchical', 'kmeans',
'diana', 'som', 'clara'),
nClust=4:15,
method='average')
summary(resclv3)
resclv3<-clValid(attsimple, validation='internal',
clMethods=c('hierarchical', 'kmeans',
'diana', 'som', 'clara'),
nClust=4:15,
method='complete')
summary(resclv3)
clusts<-cutree(hclust(attsimple, method = 'average'), 15)
clusts<-hclust(attsimple, method = 'average')
resclv3<-clValid(attsimple, validation='internal',
clMethods=c('hierarchical', 'kmeans',
'diana', 'som', 'clara'),
nClust=4:20,
method='average')
summary(resclv3)
clusts<-hclust(dist(attsimple), method = 'average') %>% cutree(18)
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
fviz_dend(hclust(dist(attsimple), method = 'average'), k=18)
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
clusts
levels(clusts)
clusts<-hclust(dist(attsimple), method = 'average') %>%
cutree(18) %>% as.factor()
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
##explore ####
df[clusts==18,c('Player', 'Pos')]
##explore ####
df[clusts==17,c('Player', 'Pos')]
##explore ####
df[clusts==16,c('Player', 'Pos')]
##explore ####
df[clusts==15,c('Player', 'Pos')]
##explore ####
df[clusts==14,c('Player', 'Pos')]
##explore ####
df[clusts==13,c('Player', 'Pos')]
##explore ####
df[clusts==12,c('Player', 'Pos')]
##explore ####
df[clusts==11,c('Player', 'Pos')]
##explore ####
df[clusts==10,c('Player', 'Pos')]
##explore ####
df[clusts==9,c('Player', 'Pos')]
##explore ####
df[clusts==8,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
##explore ####
df[clusts==6,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
##explore ####
df[clusts==5,c('Player', 'Pos')]
##explore ####
df[clusts==4,c('Player', 'Pos')]
##explore ####
df[clusts==3,c('Player', 'Pos')]
##explore ####
df[clusts==2,c('Player', 'Pos')]
##explore ####
df[clusts==1,c('Player', 'Pos')]
fviz_dend(hclust(dist(attsimple), method = 'average'), k=18)
fviz_dend(hclust(dist(attsimple), method = 'single'), k=18)
fviz_dend(hclust(dist(attsimple), method = 'ward'), k=18)
clusts<-hclust(dist(attsimple), method = 'ward') %>%
cutree(18) %>% as.factor()
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
fviz_dend(hclust(dist(attsimple), method = 'ward'), k=10)
fviz_dend(hclust(dist(attsimple), method = 'ward'),
k=14)
fviz_dend(hclust(dist(attsimple), method = 'ward'),
k=12)
clusts<-hclust(dist(attsimple), method = 'ward') %>%
cutree(12) %>% as.factor()
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
hc<-hclust(dist(attsimple), method = 'ward')
fviz_dend(hcut(hc, k=12))
fviz_dend(cutree(hc, k=12))
clusts<-hclust(dist(attsimple), method = 'ward') %>%
cutree(8) %>% as.factor()
hc<-hcut(attsimple, k=8)
fviz_dend(hc)
hc$order
hc$labels
hc$silinfo
fviz_silhouette(hc)
?hclust
test<-fviz_dend(hc)
test$labels
test$guides
test$mapping
hc<-hcut(attsimple, k=8, hc_method = 'ward.D1')
hc<-hcut(attsimple, k=8, hc_method = 'ward')
fviz_dend(hc)
fviz_silhouette(hc)
hc<-hcut(attsimple, k=6, hc_method = 'ward')
fviz_dend(hc)
fviz_silhouette(hc)
hc<-hcut(attsimple, k=10, hc_method = 'ward')
fviz_dend(hc)
fviz_silhouette(hc)
hc<-hcut(attsimple, k=12, hc_method = 'ward')
fviz_dend(hc)
fviz_silhouette(hc)
hc<-hcut(attsimple, k=11, hc_method = 'ward')
fviz_dend(hc)
fviz_silhouette(hc)
clusts<-hc$cluster
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
clusts<-hc$cluster %>% as.factor()
##radars####
#makegroups
for (i in levels(clusts)){
assign(paste0('group', i), simple[clusts==i,])
}
#makeaggs
for (i in levels(clusts)){
assign(paste0('groupaggs', i),
get(paste0('group', i)) %>% summarise_all(median))
}
#graph parameters
means<-rep(0, length(simple))
names(means)<-colnames(simple)
col <- c('#3f2199')
colors_border <- c('black', col)
colors_in <- c(scales::alpha('white', 0), scales::alpha(col,0.3))
#make dfs for radars
for (i in levels(clusts)){
assign(paste0('radardf', i),
rbind(rep(3, length(simple)),
rep(-3, length(simple)),
means,
get(paste0('groupaggs',i))))
}
#make radars
library(fmsb)
for (i in levels(clusts)){
radarchart(get(paste0('radardf', i)),
pty=32,
pcol=colors_border, pfcol=colors_in,plwd=c(2,4),plty=1,
cglcol='grey', cglty=1, axislabcol = 'black', cglwd=1.5,
centerzero = T,
title=paste('Group', i)
)
}
##explore ####
df[clusts==11,c('Player', 'Pos')]
##explore ####
df[clusts==10,c('Player', 'Pos')]
##explore ####
df[clusts==9,c('Player', 'Pos')]
##explore ####
df[clusts==8,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
##explore ####
df[clusts==6,c('Player', 'Pos')]
##explore ####
df[clusts==5,c('Player', 'Pos')]
##explore ####
df[clusts==4,c('Player', 'Pos')]
##explore ####
df[clusts==3,c('Player', 'Pos')]
##explore ####
df[clusts==2,c('Player', 'Pos')]
##explore ####
df[clusts==4,c('Player', 'Pos')]
##explore ####
df[clusts==3,c('Player', 'Pos')]
##explore ####
df[clusts==5,c('Player', 'Pos')]
##explore ####
df[clusts==7,c('Player', 'Pos')]
install.packages('RSelenium')
library(RSelenium)
R.Version()
